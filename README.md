# 发票报销智能助手

欢迎使用发票报销智能助手！这是一个帮助用户管理、查找和合并发票 PDF 文件的简易软件，适合那些需要处理大量发票、核算报销金额的人。通过一个直观的用户界面，您可以快速选择发票目录，自动提取发票金额，并寻找最优组合合并。软件具备智能化操作，只需简单几步，便能轻松完成发票处理。

## 核心功能亮点

**智能自动报销最优组合**：
- 通过内置的算法，软件会自动计算并查找最优发票组合，确保报销金额与发票总金额的最小差距。
- 只需将一揽子发票放入文件夹，输入目标报销金额，软件将智能地寻找最优的发票组合，方便报销和核算。  
只需将一揽子发票放入文件夹，输入目标报销金额（前提是发票的金额总计要超过报销金额），软件就会自动寻找最优发票组合，合并成一个 PDF 文件，方便报销打印。同时会生成一个 Excel 文件，标记出最佳发票组合，便于追踪和核算。

## 功能介绍

### 1. 选择发票目录
- 用户可以通过选择发票保存的文件夹，批量导入所有的 PDF 发票。

### 2. 提取发票金额
- 软件能够智能提取发票中的金额信息，无需人工逐张录入，极大提高效率。
- 支持多种格式的金额识别，包括不同类型发票中 "价税合计"、"合计" 等不同表达形式。

### 3. 查找最佳组合
- 用户输入目标报销金额后，程序会通过算法自动计算最佳发票组合，这些发票金额之和最接近您输入的目标金额，确保最优报销方案。
- 软件使用智能算法（包括动态规划等），确保结果是最优的发票组合，以减少报销差异。

### 4. 结果导出
- 最佳组合的发票会被自动合并成一个 PDF 文件，方便用户进一步操作。
- 还会生成一个 Excel 文件，详细记录发票文件名、金额及组合信息。

### 5. 直观的界面操作
- 提供一个简洁的界面，所有操作均通过按钮和输入框完成，无需复杂配置。
- 进度条实时显示处理进度。

## 安装与运行

### 1. 下载与安装
- 请前往 [GitHub 项目主页](https://github.com/yehx6/invoice-merger) 下载最新版的发布版本。
- 将下载的压缩包解压后，双击运行 `setup.exe` 进行安装。
- 安装完成后，桌面会出现一个名为 "发票报销助手" 的图标，双击即可打开软件。

### 2. 环境要求
- 系统：Windows 10/11
- Python：已打包成独立 exe 文件，无需安装 Python。

## 使用教程

### 1. 打开软件
- 双击桌面的 "发票报销智能助手" 图标，打开软件。

### 2. 选择发票目录
- 点击 "选择发票目录" 按钮，选择存放发票的文件夹。
- 软件会自动识别该文件夹下的所有 PDF 发票。

### 3. 选择导出目录
- 点击 "选择导出目录" 按钮，选择保存合并文件和 Excel 结果的文件夹。

### 4. 输入报销金额
- 在 "报销金额" 输入框中，输入您想报销的目标金额（例如：5000）。

### 5. 输入导出文件名称
- 在 "导出文件名称" 输入框中，输入生成的合并文件的名称，例如：`hebing`。
- 软件会根据您输入的名称生成两个文件：`hebing.pdf` 和 `hebing.xlsx`。

### 6. 开始处理
- 点击 "开始处理" 按钮，程序将自动查找发票组合并合并相关文件。
- 进度条会显示处理进度，完成后会弹出 "处理完成" 的提示框。

### 7. 查看最佳组合
- 在界面下方的数据框中，软件会显示最佳组合内的发票文件名、金额、总计金额及与报销金额的差值。

## 示例说明

### 报销 5000 元的例子
假设您需要报销 5000 元，以下是具体操作步骤和结果：

1. 打开软件，点击 "选择发票目录" 按钮，选择包含发票的文件夹。
2. 点击 "选择导出目录" 按钮，选择保存结果的目录。
3. 在 "报销金额" 输入框中输入 `5000`，并在 "导出文件名称" 输入框中输入 `hebing5000`。
4. 点击 "开始处理" 按钮，软件将自动计算并查找最接近 5000 元的发票组合。
5. 完成后，软件会生成 `hebing5000.pdf` 和 `hebing5000.xlsx` 两个文件，保存在您选择的导出目录中。
6. `hebing5000.xlsx` 文件中会列出组合内的发票文件名、每张发票的金额及组合信息。
7. 在界面下方的数据框中，可以查看到最佳组合的详细信息，例如：
   - 文件名：发票A.pdf，金额：2000 元
   - 文件名：发票B.pdf，金额：1500 元
   - 文件名：发票C.pdf，金额：1500 元
   - 总计金额：5000 元
   - 与报销金额的差值：0 元

通过以上步骤，您可以轻松找到最优的发票组合，并导出合并后的文件，方便进一步的报销操作。

## 注意事项

- 如果导出文件已存在，软件会直接覆盖该文件，因此请确保文件名的唯一性，或备份重要文件。
- 最佳组合计算可能需要几分钟，具体时间取决于发票数量和目标金额。
- 请确保发票文件格式规范，软件会自动跳过识别失败的发票。

## 界面预览

以下是发票报销智能助手的操作界面示例：

- 界面顶部有文件目录选择按钮和报销金额输入框，用户可以轻松选择发票和保存结果的目录。
- 界面中间部分显示进度条，实时显示处理进度。
- 界面底部的数据框显示最佳组合发票的详细信息，包括文件名、金额、总金额及差值。
- 整个界面布局整洁、功能明确，适合没有技术背景的用户上手操作。

![界面示例](https://github.com/yehx6/invoice-merger/blob/main/QQ20241017-103614.png)

## 常见问题

### 1. 无法找到合适的组合怎么办？
- 如果程序提示 "没有找到合适的组合"，请检查您的报销金额，可能没有合适的发票组合能达到目标金额。
- 试着降低目标金额，增加找到最佳组合的可能性。

### 2. 如何处理无法识别的发票？
- 软件会在结果中显示 "未找到金额" 的发票文件名，您可以手动检查这些发票，确保它们符合标准格式。

### 3. 导出文件在哪？
- 导出文件会保存到您选择的导出目录中，文件名为您输入的名称加上 `.pdf` 和 `.xlsx` 后缀。

## 贡献与反馈

欢迎大家为本项目贡献代码或提出改进建议！

如需进一步帮助或有任何问题，欢迎通过微信联系软件作者：

![微信二维码](https://github.com/yehx6/invoice-merger/blob/main/wechat.png)

- GitHub 项目地址：[https://github.com/username/invoice-merger](https://github.com/username/invoice-merger)
- 如果在使用过程中遇到问题，请在 GitHub 提交 issue 或联系我。

## 许可证

本项目采用 MIT 许可证开源，您可以自由使用、修改和分发。

感谢您的使用！希望本助手能为您带来便利！

